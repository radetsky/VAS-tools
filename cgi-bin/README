Пишу алгоритм решения нахождения данных для трех колонок статистики 

0. Не забыть включить транзакции. так быстрее. 

1. найти все записи в нужном диапазоне для первого этапа/контекста (warning)
2. --//-- для втого этапа/контекста (greeting)
3. Найти совпадающие записи между вторым и первым списком по calldate_cdr, callerid, custom_dst 
 и вычислить разницу между moment.  Это и будет указанное время ожидания в секундах. 

   Если запись во втором этапе не найдена, то искать запись в CDR. 
	 Взять оттуда cdr_start, после чего прибавить billsec. Таким образом получим результат cdr_stop.
	 Взять интервал cdr_stop  и moment из первой колонки и получить время проведенное в контексте/этапе.
	
Повторить для всех этапов. 

Для оптимизации стоит сначала вычитать все данные за период из ivr.navigation_taps_....
К таблице cdr не так часто обращаются и данных там может быть дофига, поэтому к ней обращаться только за конкретными данными.



